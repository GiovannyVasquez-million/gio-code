<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIO CODE PRO | Engineering Environment</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* =========================================
           SISTEMA DE IDENTIDAD VISUAL (CSS)
           =========================================
        */
        :root {
            --cobalt: #0052FF;
            --cobalt-dark: #003EB3;
            --cobalt-light: #EBF1FF;
            --white: #FFFFFF;
            --slate-50: #F8FAFC;
            --slate-100: #F1F5F9;
            --slate-200: #E2E8F0;
            --slate-400: #94A3B8;
            --slate-800: #1E293B;
            --slate-900: #0F172A;
            --shadow-soft: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-heavy: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background: var(--white); 
            color: var(--slate-900); 
            font-family: 'Inter', sans-serif; 
            overflow: hidden; 
            height: 100vh;
        }

        /* Lluvia Matrix Estilo "Cyber-Zen" */
        #matrix-bg {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            opacity: 0.08;
            filter: blur(0.5px);
        }

        /* BARRA DE NAVEGACIÃ“N PROFESIONAL */
        nav {
            height: 72px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--slate-200);
            display: flex;
            align-items: center;
            padding: 0 40px;
            position: fixed;
            top: 0; width: 100%;
            z-index: 1000;
        }

        .nav-history { display: flex; gap: 8px; }
        
        .history-btn {
            width: 36px; height: 36px;
            border-radius: 10px;
            border: 1px solid var(--slate-200);
            background: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .history-btn:hover { background: var(--slate-100); border-color: var(--cobalt); color: var(--cobalt); }
        .history-btn svg { width: 18px; height: 18px; fill: none; stroke: currentColor; stroke-width: 2.5; }

        .logo {
            flex-grow: 1;
            text-align: center;
            font-weight: 800;
            font-size: 1.4rem;
            letter-spacing: -1px;
        }

        .logo span { color: var(--cobalt); }

        .hud-stats { display: flex; align-items: center; gap: 24px; }

        .pill {
            background: var(--cobalt-light);
            color: var(--cobalt);
            padding: 6px 14px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* ESTRUCTURA DE PANTALLAS */
        .app-view {
            position: absolute;
            top: 72px; bottom: 0; left: 0; right: 0;
            display: none;
            overflow-y: auto;
            padding: 40px;
            background: var(--white);
        }

        .app-view.active { display: flex; flex-direction: column; animation: view-enter 0.5s ease; }

        @keyframes view-enter { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* HERO / BIENVENIDA */
        .hero-section {
            max-width: 1100px;
            margin: 60px auto;
            text-align: center;
        }

        .hero-section h1 { font-size: 4.5rem; font-weight: 800; letter-spacing: -3px; line-height: 1; margin-bottom: 24px; }
        .hero-section p { font-size: 1.2rem; color: var(--slate-400); max-width: 600px; margin: 0 auto 40px; }

        .btn-primary {
            background: var(--cobalt);
            color: var(--white);
            padding: 16px 36px;
            border-radius: 12px;
            font-weight: 700;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 10px 15px -3px rgba(0, 82, 255, 0.3);
        }

        .btn-primary:hover { background: var(--cobalt-dark); transform: translateY(-2px); }

        /* SELECTOR DE LENGUAJE */
        .language-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
            max-width: 1200px;
            margin: 40px auto;
        }

        .lang-card {
            background: var(--white);
            border: 1px solid var(--slate-200);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .lang-card:hover { border-color: var(--cobalt); transform: translateY(-8px); box-shadow: var(--shadow-heavy); }
        .lang-card svg { width: 56px; height: 56px; margin-bottom: 20px; color: var(--cobalt); }
        .lang-card h3 { font-weight: 800; margin-bottom: 8px; }
        .lang-card p { font-size: 0.9rem; color: var(--slate-400); }

        /* DASHBOARD - MAPA DE NIVELES */
        .dashboard-layout {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 40px;
            max-width: 1300px;
            margin: 0 auto;
        }

        .stats-card {
            background: var(--slate-50);
            padding: 30px;
            border-radius: 24px;
            border: 1px solid var(--slate-200);
            height: fit-content;
        }

        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }

        .module-box {
            background: var(--white);
            border: 1px solid var(--slate-200);
            border-radius: 20px;
            padding: 24px;
        }

        .node-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .node {
            aspect-ratio: 1;
            border-radius: 8px;
            border: 1px solid var(--slate-200);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
        }

        .node.locked { opacity: 0.3; cursor: not-allowed; }
        .node.unlocked { color: var(--cobalt); border-color: var(--cobalt); }
        .node.current { background: var(--cobalt); color: var(--white); border-color: var(--cobalt); box-shadow: 0 4px 10px rgba(0, 82, 255, 0.3); }

        /* INTERFAZ DE JUEGO (GAME ENGINE) */
        #game-view {
            position: fixed;
            inset: 0;
            background: var(--white);
            z-index: 5000;
            display: none;
            flex-direction: column;
        }

        .game-nav {
            height: 72px;
            border-bottom: 1px solid var(--slate-200);
            padding: 0 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .quest-container {
            width: 1000px;
            margin: 30px auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .code-editor {
            background: var(--slate-900);
            color: var(--white);
            padding: 24px;
            border-radius: 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            line-height: 1.6;
            border: 4px solid var(--slate-800);
        }

        .options-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .opt-btn {
            background: var(--slate-50);
            border: 1px solid var(--slate-200);
            padding: 20px;
            border-radius: 12px;
            text-align: left;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .opt-btn:hover { border-color: var(--cobalt); background: var(--cobalt-light); }

        #canvas-wrap {
            position: relative;
            width: 1000px;
            margin: 0 auto;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: var(--shadow-heavy);
            border: 1px solid var(--slate-200);
        }

        canvas#stage { background: var(--slate-50); display: block; }

        /* FORMULARIOS DE ACCESO */
        .auth-card {
            max-width: 440px;
            margin: 100px auto;
            background: var(--white);
            padding: 50px;
            border-radius: 30px;
            border: 1px solid var(--slate-200);
            box-shadow: var(--shadow-heavy);
        }

        .input-group { margin-bottom: 24px; }
        .input-group label { display: block; margin-bottom: 10px; font-weight: 600; font-size: 0.85rem; }
        .input-group input {
            width: 100%;
            padding: 14px 18px;
            border-radius: 12px;
            border: 1px solid var(--slate-200);
            background: var(--slate-50);
            font-size: 1rem;
            transition: var(--transition);
        }

        .input-group input:focus { outline: none; border-color: var(--cobalt); background: var(--white); box-shadow: 0 0 0 4px var(--cobalt-light); }

        /* TIENDA */
        .shop-modal {
            position: fixed;
            inset: 0;
            background: rgba(255,255,255,0.98);
            z-index: 6000;
            display: none;
            padding: 100px 60px;
        }

        .shop-header { display: flex; justify-content: space-between; max-width: 1200px; margin: 0 auto 60px; }

        .item-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 32px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .item-card {
            border: 1px solid var(--slate-200);
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            transition: var(--transition);
        }

        .item-card:hover { border-color: var(--cobalt); transform: translateY(-10px); box-shadow: var(--shadow-heavy); }

        /* NOTIFICACIONES */
        #toast {
            position: fixed;
            bottom: 40px; left: 50%; transform: translateX(-50%);
            background: var(--slate-900);
            color: var(--white);
            padding: 16px 32px;
            border-radius: 50px;
            font-weight: 600;
            z-index: 10000;
            display: none;
        }

    </style>
</head>
<body>

    <canvas id="matrix-bg"></canvas>
    <div id="toast">Mensaje de Sistema</div>

    <nav>
        <div class="nav-history">
            <button class="history-btn" onclick="Engine.router.back()">
                <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
            </button>
            <button class="history-btn" onclick="Engine.router.forward()">
                <svg viewBox="0 0 24 24"><path d="M9 18l6-6-6-6"/></svg>
            </button>
        </div>
        <div class="logo" onclick="Engine.router.go('home')">GIO<span>CODE</span></div>
        <div class="hud-stats" id="main-hud" style="display:none">
            <span style="color:var(--cobalt); font-weight:700; cursor:pointer" onclick="Engine.shop.toggle(true)">TIENDA</span>
            <div class="pill">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L1 12l11 10 11-10L12 2z"/></svg>
                <span id="hud-gems">0</span>
            </div>
            <div class="history-btn" style="border-radius:50%" onclick="Engine.router.go('auth')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            </div>
        </div>
    </nav>

    <section id="view-home" class="app-view active">
        <div class="hero-section">
            <h1>IngenierÃ­a de Software de Alto Nivel.</h1>
            <p>Bienvenido, Giovanny Alexander VÃ¡squez BanchÃ³n. Este entorno ha sido compilado para transformar la lÃ³gica en arquitectura pura.</p>
            <button class="btn-primary" onclick="Engine.router.go('auth')">COMENZAR DESPLIEGUE</button>
        </div>
    </section>

    <section id="view-auth" class="app-view">
        <div class="auth-card">
            <h2 style="font-size: 2rem; font-weight: 800; margin-bottom: 30px; letter-spacing: -1px">Acceso Seguro</h2>
            <div class="input-group">
                <label>IDENTIFICADOR DE INGENIERO</label>
                <input type="text" id="auth-user" placeholder="Usuario">
            </div>
            <div class="input-group">
                <label>TOKEN DE ACCESO</label>
                <input type="password" id="auth-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
            </div>
            <div class="input-group">
                <label>CLAVE DE RECUPERACIÃ“N</label>
                <input type="text" id="auth-word" placeholder="Tu palabra secreta">
            </div>
            <button class="btn-primary" style="width: 100%; margin-top: 10px" onclick="Engine.auth.submit()">VALIDAR CREDENCIALES</button>
            <p style="text-align: center; margin-top: 24px; color: var(--slate-400); font-size: 0.85rem">
                Usa el mismo formulario para registrar o recuperar tu cuenta.
            </p>
        </div>
    </section>

    <section id="view-selector" class="app-view">
        <div style="text-align: center; margin-bottom: 40px">
            <h2 style="font-size: 2.5rem; font-weight: 800">Rutas de EspecializaciÃ³n</h2>
            <p style="color: var(--slate-400)">Cada lenguaje contiene una arquitectura de 100 niveles Ãºnicos.</p>
        </div>
        <div class="language-grid">
            <div class="lang-card" onclick="Engine.game.setLang('Python')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                <h3>PYTHON</h3>
                <p>AI, Automation & Data</p>
            </div>
            <div class="lang-card" onclick="Engine.game.setLang('Java')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/></svg>
                <h3>JAVA</h3>
                <p>Enterprise & Android</p>
            </div>
            <div class="lang-card" onclick="Engine.game.setLang('C++')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/></svg>
                <h3>C++</h3>
                <p>High Performance Systems</p>
            </div>
            <div class="lang-card" onclick="Engine.game.setLang('HTML')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                <h3>HTML/CSS</h3>
                <p>Advanced UI Architecture</p>
            </div>
        </div>
    </section>

    <section id="view-dashboard" class="app-view">
        <div class="dashboard-layout">
            <aside class="stats-card">
                <h2 id="dash-lang-name" style="font-weight: 800; font-size: 1.8rem; margin-bottom: 8px">Python</h2>
                <p style="color: var(--slate-400); font-size: 0.9rem; margin-bottom: 24px">Estado de la misiÃ³n: <span id="dash-perc">0%</span></p>
                <div style="height: 8px; background: var(--slate-200); border-radius: 10px; margin-bottom: 30px; overflow: hidden">
                    <div id="dash-bar" style="height: 100%; background: var(--cobalt); width: 0%; transition: 1s ease"></div>
                </div>
                <button class="btn-primary" style="width: 100%" onclick="Engine.game.playCurrent()">REANUDAR CÃ“DIGO</button>
            </aside>
            <main id="levels-container" class="level-grid">
                </main>
        </div>
    </section>

    <div id="game-view">
        <header class="game-nav">
            <button class="history-btn" onclick="Engine.game.exit()"><svg viewBox="0 0 24 24"><path d="M19 12H5M5 12L12 19M5 12L12 5"/></svg></button>
            <h2 id="game-title" style="font-weight: 800">Nivel 1: Sintaxis BÃ¡sica</h2>
            <div class="pill">ðŸ’Ž <span id="game-gems">0</span></div>
        </header>
        
        <div class="quest-container">
            <p id="game-prompt" style="font-weight: 600; font-size: 1.2rem">Â¿CuÃ¡l es el mÃ©todo para imprimir en consola?</p>
            <div class="code-editor" id="game-code">print("Hello World")</div>
            <div class="options-row" id="game-options">
                </div>
        </div>

        <div id="canvas-wrap">
            <canvas id="stage"></canvas>
        </div>
        
        <div style="text-align: center; margin-top: 20px; color: var(--slate-400); font-size: 0.8rem">
            TECLAS: [W A S D] PARA MOVER | [ESPACIO] SALTAR | LLEGA AL CRISTAL DORADO
        </div>
    </div>

    <div id="shop-view" class="shop-modal">
        <div class="shop-header">
            <h1 style="font-size: 3rem; font-weight: 800; letter-spacing: -2px">Engineering Store</h1>
            <button class="btn-primary" onclick="Engine.shop.toggle(false)">CERRAR TIENDA</button>
        </div>
        <div class="item-grid">
            <div class="item-card">
                <h3 style="color: var(--cobalt)">Gravity Pulse</h3>
                <p style="margin: 15px 0; color: var(--slate-400)">Aumenta la fuerza de salto un 25% permanentemente.</p>
                <button class="btn-primary" style="background: var(--slate-50); color: var(--cobalt); box-shadow: none">500 ðŸ’Ž</button>
            </div>
            <div class="item-card">
                <h3 style="color: var(--cobalt)">Clean Runner</h3>
                <p style="margin: 15px 0; color: var(--slate-400)">Elimina la fricciÃ³n para moverte mÃ¡s rÃ¡pido.</p>
                <button class="btn-primary" style="background: var(--slate-50); color: var(--cobalt); box-shadow: none">800 ðŸ’Ž</button>
            </div>
            <div class="item-card">
                <h3 style="color: var(--cobalt)">Logic Shield</h3>
                <p style="margin: 15px 0; color: var(--slate-400)">Te permite fallar una pregunta sin reiniciar el nivel.</p>
                <button class="btn-primary" style="background: var(--slate-50); color: var(--cobalt); box-shadow: none">1200 ðŸ’Ž</button>
            </div>
        </div>
    </div>

    <script>
        /* =========================================
           ENGINE CORE - ARQUITECTURA DE SOFTWARE
           =========================================
        */

        const Engine = {
            state: {
                user: JSON.parse(localStorage.getItem('gio_pro_db')) || null,
                currentLang: 'Python',
                history: ['home'],
                hIdx: 0,
                lvl: 1
            },

            // GESTIÃ“N DE RUTAS
            router: {
                go: (viewId, skipHist = false) => {
                    document.querySelectorAll('.app-view').forEach(v => v.classList.remove('active'));
                    const target = document.getElementById('view-' + viewId);
                    if(target) target.classList.add('active');
                    
                    if(!skipHist) {
                        Engine.state.history.push(viewId);
                        Engine.state.hIdx = Engine.state.history.length - 1;
                    }
                    if(Engine.state.user) document.getElementById('main-hud').style.display = 'flex';
                },
                back: () => {
                    if(Engine.state.hIdx > 0) {
                        Engine.state.hIdx--;
                        Engine.router.go(Engine.state.history[Engine.state.hIdx], true);
                    }
                },
                forward: () => {
                    if(Engine.state.hIdx < Engine.state.history.length - 1) {
                        Engine.state.hIdx++;
                        Engine.router.go(Engine.state.history[Engine.state.hIdx], true);
                    }
                }
            },

            // SISTEMA DE SEGURIDAD
            auth: {
                submit: () => {
                    const u = document.getElementById('auth-user').value;
                    const p = document.getElementById('auth-pass').value;
                    const w = document.getElementById('auth-word').value;

                    if(!u || !p) return Engine.ui.toast("Campos requeridos.");

                    if(!Engine.state.user) {
                        // Registro nuevo
                        Engine.state.user = {
                            name: u, pass: p, word: w, gems: 100,
                            progress: { Python: 1, Java: 1, 'C++': 1, HTML: 1 }
                        };
                    } else {
                        // Intento de login o recuperaciÃ³n
                        if(Engine.state.user.name === u && Engine.state.user.word === w) {
                            Engine.state.user.pass = p; // RecuperaciÃ³n por palabra secreta
                        } else if(Engine.state.user.name !== u || Engine.state.user.pass !== p) {
                            return Engine.ui.toast("Credenciales invÃ¡lidas.");
                        }
                    }
                    
                    Engine.auth.save();
                    Engine.router.go('selector');
                },
                save: () => {
                    localStorage.setItem('gio_pro_db', JSON.stringify(Engine.state.user));
                    document.getElementById('hud-gems').innerText = Engine.state.user.gems;
                }
            },

            // LÃ“GICA DE JUEGO Y CONTENIDO
            game: {
                setLang: (lang) => {
                    Engine.state.currentLang = lang;
                    Engine.game.renderDashboard();
                    Engine.router.go('dashboard');
                },
                renderDashboard: () => {
                    const lang = Engine.state.currentLang;
                    const prog = Engine.state.user.progress[lang];
                    document.getElementById('dash-lang-name').innerText = lang;
                    document.getElementById('dash-perc').innerText = prog + "%";
                    document.getElementById('dash-bar').style.width = prog + "%";

                    const container = document.getElementById('levels-container');
                    container.innerHTML = "";

                    const modules = ["Sintaxis Core", "Control de Flujo", "Estructuras", "POO Avanzada"];
                    modules.forEach((mod, mIdx) => {
                        const box = document.createElement('div');
                        box.className = 'module-box';
                        box.innerHTML = `<h4>MÃ“DULO ${mIdx+1}: ${mod}</h4>`;
                        const nodes = document.createElement('div');
                        nodes.className = 'node-container';

                        for(let i=1; i<=25; i++) {
                            const currentGlobal = (mIdx * 25) + i;
                            const isUnlocked = currentGlobal <= prog;
                            const node = document.createElement('div');
                            node.className = `node ${currentGlobal === prog ? 'current' : (isUnlocked ? 'unlocked' : 'locked')}`;
                            node.innerText = i;
                            if(isUnlocked) node.onclick = () => Engine.game.launch(currentGlobal);
                            nodes.appendChild(node);
                        }
                        box.appendChild(nodes);
                        container.appendChild(box);
                    });
                },
                launch: (lvl) => {
                    Engine.state.lvl = lvl;
                    document.getElementById('game-view').style.display = 'flex';
                    Physics.start(lvl);
                },
                playCurrent: () => Engine.game.launch(Engine.state.user.progress[Engine.state.currentLang]),
                exit: () => {
                    document.getElementById('game-view').style.display = 'none';
                    Physics.active = false;
                }
            },

            // UI Y TIENDA
            ui: {
                toast: (msg) => {
                    const t = document.getElementById('toast');
                    t.innerText = msg; t.style.display = 'block';
                    setTimeout(() => t.style.display = 'none', 3000);
                }
            },
            shop: {
                toggle: (show) => document.getElementById('shop-view').style.display = show ? 'block' : 'none'
            }
        };

        /* =========================================
           AUREUS PHYSICS ENGINE - MOTOR 2D
           =========================================
        */

        const Physics = {
            active: false,
            ctx: null,
            canvas: null,
            player: { x: 60, y: 300, w: 24, h: 32, vx: 0, vy: 0, speed: 0.9, friction: 0.8, jump: -12, grounded: false },
            platforms: [],
            crystal: { x: 850, y: 310, w: 20, h: 25 },
            keys: {},
            bridgeOn: false,

            start: (lvl) => {
                Physics.canvas = document.getElementById('stage');
                Physics.ctx = Physics.canvas.getContext('2d');
                Physics.canvas.width = 1000;
                Physics.canvas.height = 400;
                Physics.active = true;
                Physics.bridgeOn = false;
                Physics.player.x = 60; Physics.player.y = 300;
                Physics.player.vx = 0; Physics.player.vy = 0;
                
                Physics.platforms = [
                    {x: 0, y: 350, w: 300, h: 50},
                    {x: 700, y: 350, w: 300, h: 50}
                ];

                Physics.loadChallenge(lvl);
                Physics.loop();
            },

            loadChallenge: (lvl) => {
                const lang = Engine.state.currentLang;
                const db = {
                    'Python': { q: "Â¿CÃ³mo se declara una lista?", c: "mi_lista = [1, 2, 3]", o: ["mi_lista = (1, 2)", "mi_lista = [1, 2]", "list mi_lista", "new List()"] },
                    'Java': { q: "Â¿CÃ³mo imprimes en consola?", c: "System.out.println();", o: ["console.log()", "print()", "System.out.println();", "cout <<"] },
                    'C++': { q: "Â¿CuÃ¡l es el puntero nulo?", c: "nullptr", o: ["null", "nil", "nullptr", "0x0"] },
                    'HTML': { q: "Â¿Etiqueta para scripts externos?", c: "<script src=''>", o: ["<link>", "<script src=''>", "<js>", "<code>"] }
                };

                const data = db[lang] || db['Python'];
                document.getElementById('game-title').innerText = `${lang} - Nivel ${lvl}`;
                document.getElementById('game-prompt').innerText = data.q;
                document.getElementById('game-code').innerText = data.c;
                document.getElementById('game-gems').innerText = Engine.state.user.gems;

                const optBox = document.getElementById('game-options');
                optBox.innerHTML = "";
                data.o.forEach(opt => {
                    const b = document.createElement('button');
                    b.className = 'opt-btn';
                    b.innerText = opt;
                    b.onclick = () => {
                        if(opt === data.c) {
                            Physics.bridgeOn = true;
                            Engine.ui.toast("PUENTE ACTIVADO");
                        } else {
                            Engine.ui.toast("ERROR EN SINTAXIS");
                        }
                    };
                    optBox.appendChild(b);
                });
            },

            loop: () => {
                if(!Physics.active) return;
                const p = Physics.player;
                const k = Physics.keys;

                // Controles
                if(k['KeyD'] || k['ArrowRight']) p.vx += p.speed;
                if(k['KeyA'] || k['ArrowLeft']) p.vx -= p.speed;
                if((k['Space'] || k['KeyW']) && p.grounded) { p.vy = p.jump; p.grounded = false; }

                // FÃ­sica bÃ¡sica
                p.vx *= p.friction;
                p.vy += 0.7; // Gravedad
                p.x += p.vx;
                p.y += p.vy;

                // Colisiones
                p.grounded = false;
                const currentPlats = [...Physics.platforms];
                if(Physics.bridgeOn) currentPlats.push({x: 300, y: 350, w: 400, h: 10});

                currentPlats.forEach(plt => {
                    if(p.x < plt.x + plt.w && p.x + p.w > plt.x && p.y + p.h > plt.y && p.y + p.h < plt.y + plt.h + 10) {
                        if(p.vy > 0) { p.vy = 0; p.y = plt.y - p.h; p.grounded = true; }
                    }
                });

                // Muerte por caÃ­da
                if(p.y > 450) { p.x = 60; p.y = 300; p.vx = 0; p.vy = 0; }

                // Meta
                if(p.x + p.w > Physics.crystal.x && p.y + p.h > Physics.crystal.y) {
                    Physics.win();
                    return;
                }

                Physics.draw();
                requestAnimationFrame(Physics.loop);
            },

            draw: () => {
                const ctx = Physics.ctx;
                ctx.clearRect(0, 0, 1000, 400);

                // Cristal Meta
                ctx.fillStyle = "#FFD700";
                ctx.shadowBlur = 15; ctx.shadowColor = "rgba(255, 215, 0, 0.5)";
                ctx.beginPath();
                ctx.moveTo(Physics.crystal.x + 10, Physics.crystal.y);
                ctx.lineTo(Physics.crystal.x + 20, Physics.crystal.y + 12);
                ctx.lineTo(Physics.crystal.x + 10, Physics.crystal.y + 25);
                ctx.lineTo(Physics.crystal.x, Physics.crystal.y + 12);
                ctx.fill();
                ctx.shadowBlur = 0;

                // Plataformas
                ctx.fillStyle = "#E2E8F0";
                Physics.platforms.forEach(plt => ctx.fillRect(plt.x, plt.y, plt.w, plt.h));
                
                if(Physics.bridgeOn) {
                    ctx.fillStyle = "#0052FF";
                    ctx.fillRect(300, 350, 400, 10);
                } else {
                    ctx.setLineDash([5, 5]);
                    ctx.strokeStyle = "#CBD5E1";
                    ctx.strokeRect(300, 350, 400, 1);
                    ctx.setLineDash([]);
                }

                // Jugador
                ctx.fillStyle = "#0052FF";
                ctx.fillRect(p.x, p.y, p.w, p.h);
            },

            win: () => {
                Physics.active = false;
                Engine.ui.toast("NIVEL COMPLETADO +50 ðŸ’Ž");
                const lang = Engine.state.currentLang;
                if(Engine.state.lvl === Engine.state.user.progress[lang]) {
                    Engine.state.user.progress[lang]++;
                }
                Engine.state.user.gems += 50;
                Engine.auth.save();
                setTimeout(() => {
                    Engine.game.exit();
                    Engine.game.renderDashboard();
                }, 1200);
            }
        };

        window.onkeydown = (e) => Physics.keys[e.code] = true;
        window.onkeyup = (e) => Physics.keys[e.code] = false;

        // LLUVIA MATRIX PROFESIONAL
        const mCanvas = document.getElementById('matrix-bg');
        const mCtx = mCanvas.getContext('2d');
        mCanvas.width = window.innerWidth; mCanvas.height = window.innerHeight;
        const drops = Array(Math.floor(mCanvas.width/25)).fill(1);
        function drawMatrix() {
            mCtx.fillStyle = 'rgba(255, 255, 255, 0.05)';
            mCtx.fillRect(0, 0, mCanvas.width, mCanvas.height);
            mCtx.fillStyle = '#0052FF';
            mCtx.font = '15px monospace';
            drops.forEach((y, i) => {
                const text = String.fromCharCode(0x30A0 + Math.random() * 96);
                mCtx.fillText(text, i*25, y*25);
                if(y*25 > mCanvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            });
        }
        setInterval(drawMatrix, 50);

        // InicializaciÃ³n HUD
        if(Engine.state.user) {
            document.getElementById('hud-gems').innerText = Engine.state.user.gems;
        }

    </script>
</body>
</html>